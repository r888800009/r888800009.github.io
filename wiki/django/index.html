<!DOCTYPE html>
<html>
    <head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
<meta name="theme-color" content="#000000">

<link rel="preload stylesheet" as="style" type="text/css" href="/css/css.css">

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-19124306-5', 'auto');
	
	ga('send', 'pageview');
}
</script>


<link rel="icon" type="image/png" href="/favicon.png">



<title>Django | r809&#39;s Notes</title>

<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/hybrid.min.css">

</head>
    <body><nav id="main-menu">
    
    
    <a href="https://github.com/r888800009" title="">
        GitHub
        
    </a>
    
    <a href="/about/" title="About">
        
        About
    </a>
    
    <a href="/portfolio/" title="Portfolio">
        
        Portfolio
    </a>
    
</nav>

<script>
  var prevScrollpos = window.pageYOffset;
  var menu = document.getElementById("main-menu");

  window.onscroll = function() {
    var currentScrollPos = window.pageYOffset;
    if (prevScrollpos > currentScrollPos) {
      menu.style.top = "0";
    } else {
      menu.style.top = "-50px";
    }
    prevScrollpos = currentScrollPos;
  }
</script>
<div id="main">    <h1 class="website-name" id="website-name"><a href="https://r888800009.github.io/" class="website-name">Django</a></h1>
<div id="content"><div class="date">
        <time datetime="2019-08-28 23:57:23 &#43;0800 CST">Wed, 2019 Aug 28</time>
    </div>

    <aside>
      <span onclick="tocToggle()" id="TOCStyle">
        <b>目次</b>
        <span id="TOCState"></span>
      </span>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#安裝">安裝</a></li>
    <li><a href="#使用">使用</a>
      <ul>
        <li><a href="#建立專案">建立專案</a></li>
        <li><a href="#啟動伺服器">啟動伺服器</a></li>
        <li><a href="#建立app">建立app</a></li>
        <li><a href="#python-shell">Python Shell</a></li>
        <li><a href="#注意事項">注意事項</a></li>
      </ul>
    </li>
    <li><a href="#templates">Templates</a>
      <ul>
        <li><a href="#viewspy">views.py</a></li>
        <li><a href="#templatehtml">template.html</a></li>
        <li><a href="#urlspy">urls.py</a></li>
        <li><a href="#注意事項-1">注意事項</a></li>
      </ul>
    </li>
    <li><a href="#models">Models</a>
      <ul>
        <li><a href="#建立表格">建立表格</a></li>
        <li><a href="#queryset與返回結果">QuerySet與返回結果</a></li>
      </ul>
    </li>
    <li><a href="#參考">參考</a></li>
  </ul>
</nav>
    </aside>

    <p>紀錄Django安裝、新增專案以及使用方式等。</p>
<h2 id="安裝">安裝</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># pip</span>
pip install django

<span style="color:#75715e"># archlinux</span>
sudo pacman -S python-django 
</code></pre></div><h2 id="使用">使用</h2>
<p>操作基本上透過<code>manage.py</code>去做管理。</p>
<h3 id="建立專案">建立專案</h3>
<p>建立專案，指令的<code>project_name</code>為創造出來專案的名子。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">django-admin startproject project_name
</code></pre></div><p>參見 <a href="https://docs.djangoproject.com/en/2.2/ref/django-admin/#startproject">Docs</a></p>
<h3 id="啟動伺服器">啟動伺服器</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python manage.py runserver
</code></pre></div><p>預設伺服器在 http://127.0.0.1:8000/ 執行</p>
<h3 id="建立app">建立app</h3>
<p>建立app，指令的<code>app_name</code>為app的名子。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python manage.py startapp app_name
</code></pre></div><h3 id="python-shell">Python Shell</h3>
<p>透過專案的環境變數啟動<code>python</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python manage.py shell
</code></pre></div><h3 id="注意事項">注意事項</h3>
<ul>
<li>確保使用的Python版本與Django互相對映。</li>
</ul>
<h2 id="templates">Templates</h2>
<p>reader()的<code>context</code>可以將<code>Key: value</code>(dict)對映到網頁上。
在模板的html檔案裡面加入<code>{{key}}</code>，views.py會
透過<a href="https://docs.djangoproject.com/en/2.2/topics/http/shortcuts/#render">render()</a>
相對映的值。</p>
<h3 id="viewspy">views.py</h3>
<p>位於所在的<code>app</code>。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> django.shortcuts <span style="color:#f92672">import</span> render

<span style="color:#75715e"># Create your views here.</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">view_def</span>(request):
    <span style="color:#66d9ef">return</span> render(request, <span style="color:#e6db74">&#39;template.html&#39;</span>, {
        <span style="color:#e6db74">&#39;key&#39;</span>: <span style="color:#e6db74">&#34;value&#34;</span>,
    })
</code></pre></div><h3 id="templatehtml">template.html</h3>
<p>位於資料夾<code>templates</code>，新專案可能需要自己建立一個資料夾。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span>&gt;
&lt;<span style="color:#f92672">head</span>&gt;
    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
    &lt;<span style="color:#f92672">title</span>&gt;Title&lt;/<span style="color:#f92672">title</span>&gt;
&lt;/<span style="color:#f92672">head</span>&gt;
&lt;<span style="color:#f92672">body</span>&gt;
    {{key}}
&lt;/<span style="color:#f92672">body</span>&gt;
&lt;/<span style="color:#f92672">html</span>&gt;
</code></pre></div><h3 id="urlspy">urls.py</h3>
<p>在<code>urlpatterns</code>定義一個路徑處理。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> django.contrib <span style="color:#f92672">import</span> admin
<span style="color:#f92672">from</span> django.urls <span style="color:#f92672">import</span> path
<span style="color:#f92672">from</span> test1.views <span style="color:#f92672">import</span> view_def

urlpatterns <span style="color:#f92672">=</span> [
    path(<span style="color:#e6db74">&#39;admin/&#39;</span>, admin<span style="color:#f92672">.</span>site<span style="color:#f92672">.</span>urls),
    path(<span style="color:#e6db74">&#39;test/&#39;</span>, view_def)
]
</code></pre></div><p><code>view_def</code>是<code>test1.views</code>當中的函數，用來處理頁面回傳response。</p>
<p>瀏覽 http://localhost:8000/test/ 查看結果</p>
<h3 id="注意事項-1">注意事項</h3>
<ul>
<li><code>template</code>可能會因為沒有調整正確的<code>DIRS</code>會出現問題，
調整<code>settings.py</code>當中的<code>TEMPLATES</code>。
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#e6db74">&#39;DIRS&#39;</span>: [os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(BASE_DIR, <span style="color:#e6db74">&#39;templates&#39;</span>)]
</code></pre></div></li>
</ul>
<h2 id="models">Models</h2>
<p>透過<code>models.py</code>定義表格。</p>
<h3 id="建立表格">建立表格</h3>
<pre><code>from django.db import models

# Create your models here.
class TestTable(models.Model):
    name = models.TextField(default=&quot;jack&quot;)
    bio = models.TextField(default=&quot;&quot;)
    date = models.DateTimeField(auto_now=True)

    class Meta:
        db_table = &quot;test_table&quot;
</code></pre><p>更新資料庫</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">python manage.py makemigrations
python manage.py migrate
</code></pre></div><h3 id="queryset與返回結果">QuerySet與返回結果</h3>
<p>參考<a href="https://docs.djangoproject.com/en/2.2/ref/models/querysets/">QuerySet API reference</a></p>
<h4 id="常用函數">常用函數</h4>
<ul>
<li><code>filter()</code>找出符合條件的entry，回傳<code>QuerySet</code></li>
<li><code>get()</code>取得指定的entry</li>
<li><code>create()</code>建立新的entry</li>
<li><code>update()</code>更新<code>QuerySet</code>所有entry</li>
<li><code>delete()</code>刪除entry</li>
<li><code>all()</code>取得所有entry，回傳<code>QuerySet</code></li>
</ul>
<h4 id="獲取內容">獲取內容</h4>
<ul>
<li>直接用陣列選取entry(models)並且選取欄位**(建議)**</li>
<li>透過<a href="https://docs.djangoproject.com/en/2.2/ref/models/querysets/#django.db.models.query.QuerySet.values"><code>values()</code></a>
轉換成<code>list</code>與<code>dict</code>的格式</li>
<li>獲取內容: <code>欄位內容 = entry.欄位名</code></li>
</ul>
<h2 id="參考">參考</h2>
<ul>
<li><a href="https://github.com/twtrubiks/django-tutorial">django-tutorial</a></li>
</ul>

    
      <hr>
      
        <a href="https://r888800009.github.io/tags/python" class="tags">Python</a>
      
        <a href="https://r888800009.github.io/tags/web" class="tags">Web</a>
      
        <a href="https://r888800009.github.io/tags/django" class="tags">Django</a>
      
    

    <script>
      (function addHeadingLinks(){
        var article = document.getElementById('content');
        var headings = article.querySelectorAll('h1, h2, h3, h4, h5, h6');
        headings.forEach(function(heading){
          if(heading.id){
            var a = document.createElement('a');
            a.innerHTML = '#';
            a.className = 'subheader';
            a.href = '#'+heading.id;
            heading.appendChild(a);
          }
        });
      })();
    </script>

    <script>
      function tocToggle() {
        var toc = document.getElementById("TableOfContents");
        var state = document.getElementById("TOCState");
        if (toc.style.display === "none") {
          state.innerHTML = "[hide]";
          toc.style.display = "block";
        } else {
          state.innerHTML = "[show]";
          toc.style.display = "none";
        }
      }
      
      tocToggle();
      tocToggle();
    </script>


            </div>
        </div><footer>
  <hr>
  <div>
    <a href="/tags" class="footer">Tags</a>
    <a href="#website-name" class="footer">Top</a>
  </div>
  <div>
    r888800009©2018-2021.
    All Rights Reserved.
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/r.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/haskell.min.js"></script>
<script>
  hljs.highlightAll()
  hljs.registerLanguage("plaintext",function(e){return{disableAutodetect:!0}});
</script>
</body>
</html>
